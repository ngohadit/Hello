<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Game Slot Cao Bồi</title>
  <style>
    body {
      margin: 0;
      background: url('https://i.imgur.com/FNNBkAs.jpg') no-repeat center/cover;
      font-family: 'Georgia', serif;
      color: #fff;
    }
    .game-container {
      max-width: 480px;
      margin: auto;
      padding: 10px;
      text-align: center;
    }
    .balance-bar {
      display: flex;
      justify-content: space-between;
      background: rgba(0,0,0,0.6);
      padding: 8px 12px;
      border-radius: 10px;
      margin-bottom: 10px;
    }
    .slot-machine {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      grid-template-rows: repeat(3, 80px);
      gap: 5px;
      background: #5c3d1c;
      padding: 10px;
      border-radius: 10px;
      margin-bottom: 12px;
      box-shadow: 0 0 10px #000;
    }
    .symbol {
      background: #fff3;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      font-weight: bold;
    }
    .controls {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
      align-items: center;
    }
    .btn {
      background: #e09c3d;
      color: #000;
      font-weight: bold;
      padding: 10px 15px;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 2px 4px #000;
    }
    .btn:hover {
      transform: scale(1.1);
    }
    .big-button {
      border-radius: 50%;
      font-size: 24px;
      width: 60px;
      height: 60px;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <div class="balance-bar">
      <div>Số dư: <b id="balance">₫0.16</b></div>
      <div>Cược: <b id="bet">₫1.20</b></div>
      <div>Thắng: <b id="win">₫0.00</b></div>
    </div>

    <div class="slot-machine" id="slot">
      <!-- Các ô slot -->
    </div>

    <div class="controls">
      <div class="btn" onclick="changeBet(-0.2)">–</div>
      <div class="btn big-button" onclick="spin()">⟳</div>
      <div class="btn" onclick="changeBet(0.4)">+</div>
      <div class="btn" onclick="autoSpin()">AUTO</div>
    </div>
  </div>

  <script>
    const symbols = ["A", "Q", "J", "W", "SCATTER"];
    const slot = document.getElementById("slot");
    let balance = 0.16, bet = 1.2, win = 0.00;
    let autoMode = false;

    function renderSlotGrid(grid = []) {
      slot.innerHTML = "";
      for (let i = 0; i < 15; i++) {
        const sym = grid[i] || symbols[Math.floor(Math.random() * symbols.length)];
        const div = document.createElement("div");
        div.className = "symbol";
        div.textContent = sym;
        slot.appendChild(div);
      }
    }

    function updateDisplay() {
      document.getElementById("balance").innerText = `₫${balance.toFixed(2)}`;
      document.getElementById("bet").innerText = `₫${bet.toFixed(2)}`;
      document.getElementById("win").innerText = `₫${win.toFixed(2)}`;
    }

    function changeBet(amount) {
      bet = Math.max(0.2, bet + amount);
      updateDisplay();
    }

    function spin() {
      if (balance < bet) return alert("Không đủ tiền!");
      balance -= bet;
      win = 0;

      // Tạo 5x3 ngẫu nhiên
      const grid = Array.from({ length: 15 }, () =>
        symbols[Math.floor(Math.random() * symbols.length)]
      );

      renderSlotGrid(grid);

      // Tính thắng nếu có 3 biểu tượng giống nhau liên tiếp theo hàng ngang
      for (let r = 0; r < 3; r++) {
        const row = grid.slice(r * 5, r * 5 + 5);
        let counts = {};
        row.forEach(sym => counts[sym] = (counts[sym] || 0) + 1);

        for (let [sym, count] of Object.entries(counts)) {
          if (count >= 3) {
            let reward = 0;
            if (sym === "A") reward = 0.2;
            else if (sym === "J") reward = 0.8;
            else if (sym === "W") reward = 1.2;
            else if (sym === "SCATTER") {
              reward = 0;
              alert("Bạn trúng SCATTER – quay miễn phí!");
              // TODO: thêm quay miễn phí ở đây
            }
            win += reward * bet;
          }
        }
      }

      balance += win;
      updateDisplay();
    }

    function autoSpin() {
      autoMode = !autoMode;
      if (autoMode) {
        const interval = setInterval(() => {
          if (!autoMode) return clearInterval(interval);
          spin();
        }, 2000);
      }
    }

    renderSlotGrid(); // Hiển thị ban đầu
    updateDisplay();
  </script>
</body>
</html>
